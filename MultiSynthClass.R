setClass(Class="MultiSynth", 
         representation = list(
           input = "list",
           preps = "list",
           fits = "list",
           treated = "character",
           treatment_time = "numeric",
           PreRMSPE = "numeric",
           PostRMSPE = "numeric",
           RMSPEratio = "numeric",
           CovBalances = "numeric",
           ATEs = "numeric"
         ),
         prototype = prototype(
           input = list(),
           preps = list(),
           fits = list(),
           treated = NA_character_,
           treatment_time = NA_real_,
           PreRMSPE = numeric(),
           PostRMSPE = numeric(),
           RMSPEratio = numeric(),
           CovBalances = numeric(),
           ATEs = numeric()
         )
)

setClass("PlaceboMS", contains = "MultiSynth",
         representation = list(
           p_value = "numeric"),
         prototype = prototype(
           p_value = numeric()
           )
         )
setClass("LOOunitsMS", contains = "MultiSynth")
setClass("LOOcovariatesMS", contains = "MultiSynth")

setMethod("initialize", "MultiSynth", 
          function(.Object, input = list(), preps = list(), fits = list(), treated = character(), treatment_time = numeric(), PreRMSPE = numeric(), PostRMSPE = numeric(), RMSPEratio = numeric(), CovBalances = numeric(), ATEs = numeric()
                   ){ 
            .Object@input <- input
            .Object@preps <- preps
            .Object@fits <- fits
            .Object@treated <- treated
            .Object@treatment_time <- treatment_time
            .Object@PreRMSPE <- PreRMSPE
            .Object@PostRMSPE <- PostRMSPE
            .Object@RMSPEratio <- RMSPEratio
            .Object@CovBalances <- CovBalances
            .Object@ATEs <- ATEs
            .Object
          }
)

setMethod("initialize", "PlaceboMS", 
          function(.Object, input = list(), preps = list(), fits = list(), treated = character(), treatment_time = numeric(), PreRMSPE = numeric(), PostRMSPE = numeric(), RMSPEratio = numeric(), CovBalances = numeric(), ATEs = numeric(), p_value = numeric()
          ){
            
            .Object@input <- input
            .Object@preps <- preps
            .Object@fits <- fits
            .Object@treated <- treated
            .Object@treatment_time <- treatment_time
            .Object@PreRMSPE <- PreRMSPE
            .Object@PostRMSPE <- PostRMSPE
            .Object@RMSPEratio <- RMSPEratio
            .Object@CovBalances <- CovBalances
            .Object@ATEs <- ATEs
            .Object@p_value <- p_value
            .Object
          }
)

setGeneric(name="getInput",
           def=function(input, ...)
           {standardGeneric("getInput")}
)
setMethod(f = "getInput",
          signature = "MultiSynth",
          def = function(input){
            return(input@input)
          })

setGeneric(name="getPreps",
           def=function(input, ...)
           {standardGeneric("getPreps")}
)
setMethod(f = "getPreps",
          signature = "MultiSynth",
          def = function(input){
            return(input@preps)
          })

setGeneric(name="getFits",
           def=function(input, ...)
           {standardGeneric("getFits")}
)
setMethod(f = "getFits",
          signature = "MultiSynth",
          def = function(input){
            return(input@fits)
          })

setGeneric(name="getTreated",
           def=function(input, ...)
           {standardGeneric("getTreated")}
)
setMethod(f = "getTreated",
          signature = "MultiSynth",
          def = function(input){
            return(input@treated)
          })

setGeneric(name="getTreatmentTime",
           def=function(input, ...)
           {standardGeneric("getTreatmentTime")}
)
setMethod(f = "getTreatmentTime",
          signature = "MultiSynth",
          def = function(input){
            return(input@treatment_time)
          })

setGeneric(name="getCase",
           def=function(input, case, ...)
           {standardGeneric("getCase")}
)
setMethod(f = "getCase",
          signature = "MultiSynth",
          def = function(input, case){
            return(list(dataprep = input@preps[case], synth.res = input@fits[case]))
          })

setGeneric(name = "getStats",
           def = function(input, ...)
           {standardGeneric("getStats")}
)

setMethod(f = "getStats",
         signature = "MultiSynth",
         def = function(input){
           output <- cbind(input@PreRMSPE, input@PostRMSPE, input@RMSPEratio, input@CovBalances, input@ATEs)
           rownames(output) <- names(input@PreRMSPE)
           colnames(output) <- c("Pre RMSPE", "PostRMSPE", "RMSPE ratio", "Covariate Balance", "ATE")
           return(output)
         }
           )

